#/!bin/sh

echo "Running raspi emulator"

ARGS=""
if [ "$1" = "debug" ]; then
  ARGS="-monitor unix:/tmp/qemu-monitor-socket,server,nowait -s -S"
fi

qemu-system-aarch64 \
-M raspi4b \
-kernel kernel.elf \
-display sdl \
-drive file=disk.img,if=none,format=raw,id=hd0 \
-netdev vmnet-bridged,id=net0,ifname=en0 \
-serial mon:stdio \
-d guest_errors \
$ARGS
