#/!bin/sh

echo "Cleaning project"
make clean
echo "Building project"
make
echo "Running emulator"

ARGS=""
if [ "$1" = "debug" ]; then
  ARGS="-monitor unix:/tmp/qemu-monitor-socket,server,nowait -s -S"
fi

../qemu/build/qemu-system-aarch64-unsigned \
-M virt \
-cpu cortex-a72 \
-m 512M \
-kernel kernel.elf \
-device ramfb \
-display sdl \
-serial mon:stdio \
$ARGS
